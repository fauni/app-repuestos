<section class="content">
    <div class="content-block">
        <div class="block-header">
            <!-- breadcrumb -->
            <app-breadcrumb [title]="'Crear Producto'" [items]="['Inicio','Producto']" [active_item]="'Nuevo'"></app-breadcrumb>
        </div>

    </div>

    <div class="row">
        <div class="col-xl-12 col-lg-12 col-md-12 col-sm-12">
          <div class="card">
            <div class="header">
              <h2>{{productoId >0 ?'Modificar': 'Crear'}} Producto </h2>
            </div>
            <div class="body">
                <form class="register-form m-4" [formGroup]="registrar" (ngSubmit)="onGuardar()" enctype="multipart/form-data">
                    <div class="row">
                        <div class="col-3">
                            <mat-form-field class="example-full-width" appearance="fill">
                                <mat-label>Codigo</mat-label>
                                <input matInput formControlName="codigo">
                                <mat-error *ngIf="registrar.get('codigo')?.hasError('required')">
                                    El código es requerido
                                </mat-error>
                            </mat-form-field>   
                        </div>
                        <div class="col-3">
                            <mat-form-field class="example-full-width" appearance="fill">
                                <mat-label>Codigo de Barras</mat-label>
                                <input matInput formControlName="codigo_barras">
                                <mat-icon class="material-icons-two-tone color-icon p-3" matSuffix></mat-icon>
                            </mat-form-field>
                        </div>
                        <div class="col-6">
                            <mat-form-field class="example-full-width" appearance="fill">
                                <mat-label>Nombre</mat-label>
                                <input matInput formControlName="nombre">
                            </mat-form-field>
                        </div>
                        <div class="col-12">
                            <mat-form-field class="example-full-width" appearance="fill">
                                <mat-label>Descripción</mat-label>
                                <input matInput formControlName="descripcion">
                            </mat-form-field>
                        </div>
                        
                        <!-- <div class="col-xl-8 col-lg-12 col-md-12 col-sm-12 mb-3">
                            <mat-label>Imagen del Producto</mat-label>
                            <app-file-upload formControlName="fileUpload" (onChange)="showPreview($event)"></app-file-upload>
                        </div> -->
                        <div class="col-xl-8 col-lg-12 col-md-12 col-sm-12 mb-3">
                            <mat-label>Imagen del Producto</mat-label>
                            <input type="file" accept="image/*" formControlName="fileUpload" (change)="onFileSelected($event)" />
                        </div>

                        <div class="col-xl-4 col-lg-12 col-md-12 col-sm-12 mb-3">
                            <br>
                            <div class="contenido-imagen">
                                <img *ngIf="imagenSeleccionada" class="imagen-producto" [src]="imagenSeleccionada" [alt]="registrar.value.nombre"> 
                            </div>
                           
                        </div>
        
                        <div class="col-4">
                            <mat-form-field class="example-full-width" appearance="fill">
                                <mat-label>Unidad de Medida</mat-label>
                                <mat-select formControlName="unidad">
                                    <mat-option value="1">Unidades</mat-option>
                                    <mat-option value="2">Kilogramos</mat-option>
                                    <mat-option value="3">Litros</mat-option>
                                </mat-select>
                            </mat-form-field>
                        </div>
        
                        <div class="col-4">
                            <section class="example-section">
                                <mat-checkbox formControlName="usa_inventarios" class="example-margin">Usa Inventarios</mat-checkbox>
                            </section>
                        </div>
                        <div class="col-4">
                            <section class="example-section">
                                <mat-checkbox formControlName="usa_lotes" class="example-margin">Usa Lotes</mat-checkbox>
                            </section>
                        </div>
                        
                        <div class="col-3">
                            <mat-form-field class="example-full-width" appearance="fill">
                              <mat-label>Stock</mat-label>
                              <input matInput formControlName="stock" type="number" class="example-right-align" readonly>
                            </mat-form-field>
                        </div>
                        <div class="col-3">
                            <mat-form-field class="example-full-width" appearance="fill">
                              <mat-label>Stock Mínimo</mat-label>
                              <input matInput formControlName="stock_minimo" type="number" class="example-right-align">
                            </mat-form-field>
                        </div>
                        <div class="col-3">
                            <mat-form-field class="example-full-width" appearance="fill">
                              <mat-label>Precio de Compra</mat-label>
                              <input matInput formControlName="precio_compra" type="number" class="example-right-align">
                              <span matPrefix>Bs. &nbsp;</span>
                            </mat-form-field>
                        </div>
                        <div class="col-3">
                            <mat-form-field class="example-full-width" appearance="fill">
                              <mat-label>Precio de Venta</mat-label>
                              <input matInput formControlName="precio_venta" type="number" class="example-right-align">
                              <span matPrefix>Bs. &nbsp;</span>
                            </mat-form-field>
                        </div>
        
                        <div class="col-4">
                            <mat-form-field class="example-full-width" appearance="fill">
                                <mat-label>Categoría</mat-label>
                                <mat-select formControlName="categoria">
                                    <mat-option *ngFor="let item of categorias" [value]="item.id">{{item.descripcion}}</mat-option>
                                </mat-select>
                            </mat-form-field>
                        </div>
                        <div class="col-4">
                            <mat-form-field class="example-full-width" appearance="fill">
                                <mat-label>Grupo</mat-label>
                                <mat-select formControlName="grupo">
                                    <mat-option *ngFor="let item of grupos" [value]="item.id">{{ item.descripcion }}</mat-option>
                                </mat-select>
                            </mat-form-field>
                        </div>
                        <div class="col-4">
                            <mat-form-field class="example-full-width" appearance="fill">
                                <mat-label>Proveedor</mat-label>
                                <mat-select formControlName="proveedor">
                                    <mat-option *ngFor="let item of proveedores" [value]="item.id">{{ item.nombre }}</mat-option>
                                </mat-select>
                            </mat-form-field>
                        </div>
                    </div>
                    <hr>
                    <div class="row">
                        <div class="col-xl-12 col-lg-12 col-md-12 col-sm-12 mb-2">
                          <button class="btn-space" mat-raised-button color="primary"
                            [class.auth-spinner]="status === 'loading'"
                            [disabled]="!registrar.valid">{{productoId > 0 ?'Guardar Cambios': 'Guardar'}}</button>
                          <button type="button" mat-button>Cancelar</button>
                        </div>
                    </div>
                </form>
                <!-- <pre>
                    {{ registrar.value | json }}
                </pre> -->
            </div>
          </div>
        </div>
      </div>
</section>